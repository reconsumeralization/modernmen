---
globs: src/app/**/*.tsx,src/app/**/*.ts
description: Page Navigation and Routing Patterns
---

# ğŸ—ºï¸ **PAGE NAVIGATION & ROUTING SYSTEM**

## **Route Structure Overview:**

```
src/app/
â”œâ”€â”€ page.tsx                    # Homepage (/)
â”œâ”€â”€ auth/                       # Authentication Pages
â”‚   â”œâ”€â”€ signin/page.tsx         # Login (/auth/signin)
â”‚   â”œâ”€â”€ signup/page.tsx         # Registration (/auth/signup)
â”‚   â”œâ”€â”€ forgot-password/page.tsx # Password Reset (/auth/forgot-password)
â”‚   â””â”€â”€ reset-password/page.tsx # Password Reset Form (/auth/reset-password)
â”œâ”€â”€ portal/                     # Customer Portal
â”‚   â”œâ”€â”€ page.tsx                # Portal Dashboard (/portal)
â”‚   â”œâ”€â”€ login/page.tsx          # Portal Login (/portal/login)
â”‚   â”œâ”€â”€ book/page.tsx           # Booking Flow (/portal/book)
â”‚   â””â”€â”€ profile/page.tsx        # Customer Profile (/portal/profile)
â”œâ”€â”€ admin/                      # Admin Dashboard
â”‚   â”œâ”€â”€ page.tsx                # Admin Overview (/admin)
â”‚   â”œâ”€â”€ analytics/              # Analytics Pages
â”‚   â”‚   â””â”€â”€ page.tsx            # Analytics Dashboard (/admin/analytics)
â”‚   â”œâ”€â”€ dashboard/              # Main Dashboard
â”‚   â”‚   â””â”€â”€ page.tsx            # Admin Dashboard (/admin/dashboard)
â”‚   â””â”€â”€ payload/                # Payload CMS Interface
â”‚       â””â”€â”€ page.tsx            # CMS Admin Panel (/admin/payload)
â””â”€â”€ api/                        # API Routes
    â”œâ”€â”€ appointments/           # Appointment Management
    â”œâ”€â”€ customers/              # Customer Management
    â”œâ”€â”€ auth/                   # Authentication
    â””â”€â”€ healthcheck/            # System Health
```

## **Navigation Patterns:**

### **1. Public â†’ Authenticated Flow**
```
Public Website â†’ Authentication â†’ Portal/Dashboard
     â†“                â†“                â†“
Homepage (/) â†’ Login (/auth/signin) â†’ Portal (/portal)
```

### **2. Customer Journey Flow**
```
Discovery â†’ Interest â†’ Booking â†’ Service â†’ Retention
    â†“         â†“         â†“        â†“        â†“
Homepage â†’ Services â†’ Portal â†’ In-Store â†’ Follow-up
```

### **3. Admin Workflow**
```
Login â†’ Dashboard â†’ Content Management â†’ Analytics
   â†“        â†“              â†“                â†“
/admin â†’ /admin/dashboard â†’ /admin/payload â†’ /admin/analytics
```

## **Page Component Patterns:**

### **Layout Components:**
```tsx
// src/app/layout.tsx - Root Layout
// src/app/portal/layout.tsx - Portal Layout
// src/app/admin/layout.tsx - Admin Layout
```

### **Page Components:**
```tsx
// Each page.tsx should export default function
export default function PageName() {
  return (
    <div>
      {/* Page content */}
    </div>
  )
}
```

### **Dynamic Routes:**
```tsx
// src/app/appointments/[id]/page.tsx
export default function AppointmentDetail({ params }: { params: { id: string } }) {
  return <AppointmentDetailView id={params.id} />
}
```

## **Navigation Guards:**

### **Authentication Required:**
```tsx
// For protected routes
import { useSession } from 'next-auth/react'
import { useRouter } from 'next/navigation'

export default function ProtectedPage() {
  const { data: session, status } = useSession()
  const router = useRouter()

  useEffect(() => {
    if (status === 'loading') return
    if (!session) router.push('/portal/login')
  }, [session, status, router])

  if (status === 'loading') return <LoadingSpinner />
  if (!session) return null

  return <ProtectedContent />
}
```

### **Role-Based Access:**
```tsx
// Check user roles for admin pages
const { data: session } = useSession()
const userRole = session?.user?.role

if (userRole !== 'admin') {
  return <AccessDenied />
}
```

## **URL Patterns:**

### **Public Routes:**
- `/` - Homepage
- `/services` - Services page
- `/about` - About page
- `/contact` - Contact page

### **Authentication Routes:**
- `/auth/signin` - Sign in
- `/auth/signup` - Sign up
- `/auth/forgot-password` - Password reset request
- `/auth/reset-password` - Password reset form

### **Customer Portal:**
- `/portal` - Portal dashboard
- `/portal/login` - Portal login
- `/portal/book` - Booking flow
- `/portal/profile` - Customer profile
- `/portal/services` - Service selection

### **Admin Routes:**
- `/admin` - Admin overview
- `/admin/dashboard` - Admin dashboard
- `/admin/analytics` - Analytics
- `/admin/payload` - CMS interface

### **API Routes:**
- `/api/appointments` - Appointment management
- `/api/customers` - Customer management
- `/api/auth/[...nextauth]` - NextAuth handlers
- `/api/healthcheck` - System health

## **Common Navigation Patterns:**

### **Programmatic Navigation:**
```tsx
import { useRouter } from 'next/navigation'

const router = useRouter()

// Navigate to booking page
router.push('/portal/book')

// Navigate with state
router.push('/portal/book?service=classic-haircut')

// Go back
router.back()
```

### **Conditional Rendering:**
```tsx
// Show different content based on auth status
{session ? (
  <AuthenticatedContent />
) : (
  <LoginPrompt />
)}
```

### **Loading States:**
```tsx
if (status === 'loading') {
  return <LoadingSpinner />
}
```