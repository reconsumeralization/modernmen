---
globs: src/app/**/*.tsx,src/app/**/*.ts
description: Page Navigation and Routing Patterns
---

# 🗺️ **PAGE NAVIGATION & ROUTING SYSTEM**

## **Route Structure Overview:**

```
src/app/
├── page.tsx                    # Homepage (/)
├── auth/                       # Authentication Pages
│   ├── signin/page.tsx         # Login (/auth/signin)
│   ├── signup/page.tsx         # Registration (/auth/signup)
│   ├── forgot-password/page.tsx # Password Reset (/auth/forgot-password)
│   └── reset-password/page.tsx # Password Reset Form (/auth/reset-password)
├── portal/                     # Customer Portal
│   ├── page.tsx                # Portal Dashboard (/portal)
│   ├── login/page.tsx          # Portal Login (/portal/login)
│   ├── book/page.tsx           # Booking Flow (/portal/book)
│   └── profile/page.tsx        # Customer Profile (/portal/profile)
├── admin/                      # Admin Dashboard
│   ├── page.tsx                # Admin Overview (/admin)
│   ├── analytics/              # Analytics Pages
│   │   └── page.tsx            # Analytics Dashboard (/admin/analytics)
│   ├── dashboard/              # Main Dashboard
│   │   └── page.tsx            # Admin Dashboard (/admin/dashboard)
│   └── payload/                # Payload CMS Interface
│       └── page.tsx            # CMS Admin Panel (/admin/payload)
└── api/                        # API Routes
    ├── appointments/           # Appointment Management
    ├── customers/              # Customer Management
    ├── auth/                   # Authentication
    └── healthcheck/            # System Health
```

## **Navigation Patterns:**

### **1. Public → Authenticated Flow**
```
Public Website → Authentication → Portal/Dashboard
     ↓                ↓                ↓
Homepage (/) → Login (/auth/signin) → Portal (/portal)
```

### **2. Customer Journey Flow**
```
Discovery → Interest → Booking → Service → Retention
    ↓         ↓         ↓        ↓        ↓
Homepage → Services → Portal → In-Store → Follow-up
```

### **3. Admin Workflow**
```
Login → Dashboard → Content Management → Analytics
   ↓        ↓              ↓                ↓
/admin → /admin/dashboard → /admin/payload → /admin/analytics
```

## **Page Component Patterns:**

### **Layout Components:**
```tsx
// src/app/layout.tsx - Root Layout
// src/app/portal/layout.tsx - Portal Layout
// src/app/admin/layout.tsx - Admin Layout
```

### **Page Components:**
```tsx
// Each page.tsx should export default function
export default function PageName() {
  return (
    <div>
      {/* Page content */}
    </div>
  )
}
```

### **Dynamic Routes:**
```tsx
// src/app/appointments/[id]/page.tsx
export default function AppointmentDetail({ params }: { params: { id: string } }) {
  return <AppointmentDetailView id={params.id} />
}
```

## **Navigation Guards:**

### **Authentication Required:**
```tsx
// For protected routes
import { useSession } from 'next-auth/react'
import { useRouter } from 'next/navigation'

export default function ProtectedPage() {
  const { data: session, status } = useSession()
  const router = useRouter()

  useEffect(() => {
    if (status === 'loading') return
    if (!session) router.push('/portal/login')
  }, [session, status, router])

  if (status === 'loading') return <LoadingSpinner />
  if (!session) return null

  return <ProtectedContent />
}
```

### **Role-Based Access:**
```tsx
// Check user roles for admin pages
const { data: session } = useSession()
const userRole = session?.user?.role

if (userRole !== 'admin') {
  return <AccessDenied />
}
```

## **URL Patterns:**

### **Public Routes:**
- `/` - Homepage
- `/services` - Services page
- `/about` - About page
- `/contact` - Contact page

### **Authentication Routes:**
- `/auth/signin` - Sign in
- `/auth/signup` - Sign up
- `/auth/forgot-password` - Password reset request
- `/auth/reset-password` - Password reset form

### **Customer Portal:**
- `/portal` - Portal dashboard
- `/portal/login` - Portal login
- `/portal/book` - Booking flow
- `/portal/profile` - Customer profile
- `/portal/services` - Service selection

### **Admin Routes:**
- `/admin` - Admin overview
- `/admin/dashboard` - Admin dashboard
- `/admin/analytics` - Analytics
- `/admin/payload` - CMS interface

### **API Routes:**
- `/api/appointments` - Appointment management
- `/api/customers` - Customer management
- `/api/auth/[...nextauth]` - NextAuth handlers
- `/api/healthcheck` - System health

## **Common Navigation Patterns:**

### **Programmatic Navigation:**
```tsx
import { useRouter } from 'next/navigation'

const router = useRouter()

// Navigate to booking page
router.push('/portal/book')

// Navigate with state
router.push('/portal/book?service=classic-haircut')

// Go back
router.back()
```

### **Conditional Rendering:**
```tsx
// Show different content based on auth status
{session ? (
  <AuthenticatedContent />
) : (
  <LoginPrompt />
)}
```

### **Loading States:**
```tsx
if (status === 'loading') {
  return <LoadingSpinner />
}
```